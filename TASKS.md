# DualTab Chrome插件重构任务清单

## 项目概述
将传统JavaScript实现的DualTab Chrome插件迁移到React + Shadcn/UI技术栈。

源项目分析：
- 功能丰富的新标签页插件，支持内外网双模式
- 包含书签管理、分类系统、背景图片管理、WebDAV同步等核心功能
- 使用模块化架构，HTML片段动态加载
- 支持多种图标类型（官方、文字、上传）和自定义背景色

---

## 功能模块 1：基础架构与配置（优先级：高）
- [x] 子功能 1.1：配置Chrome插件基础结构
  - 完成日期：2025-05-22
  - 实现方式：修复TypeScript配置和构建脚本
  - 修改/新增文件：
    - tsconfig.scripts.json（新增）
    - tsconfig.json（更新）
    - tsconfig.app.json（更新）
    - tsconfig.node.json（更新）
    - package.json（更新构建脚本）
    - src/content/content-script.ts（修复未使用参数警告）
  - 测试方法：运行 `npm run build` 命令成功构建，生成dist目录
  - 备注：
    - 解决了TypeScript JSX配置问题
    - 解决了Chrome扩展脚本的DOM类型问题
    - 分离了React应用和扩展脚本的TypeScript配置
    - 构建脚本分为build（快速构建）和build:check（包含类型检查）
  
- [x] 子功能 1.2：建立核心存储与工具模块
  - 完成日期：2025-05-22
  - 实现方式：完全现代化重构，使用TypeScript和React Hooks
  - 修改/新增文件：
    - src/types/index.ts（新增）- 完整的TypeScript类型定义
    - src/utils/storage.ts（新增）- 现代化存储API封装，支持缓存和错误处理
    - src/utils/bookmark-utils.ts（新增）- 完整的书签操作工具函数
    - src/models/BookmarkCategory.ts（新增）- 分类数据模型和工具函数
    - src/hooks/useStorage.ts（新增）- 存储相关React Hooks
    - src/hooks/useSplashApi.ts（新增）- Unsplash API管理Hook
    - src/hooks/useDataBackup.ts（新增）- 数据备份恢复Hook
    - src/hooks/useBookmarks.ts（新增）- 书签管理Hook
    - src/utils/index.ts（新增）- 工具函数统一导出
    - src/hooks/index.ts（新增）- Hooks统一导出
  - 测试方法：可通过import测试各模块功能，Chrome存储API调用正常
  - 备注：
    - **代码结构优化**：拆分为更小的模块，提高代码可维护性
    - **类型安全**：完整的TypeScript类型定义，避免运行时错误
    - **性能优化**：实现内存缓存机制，减少Chrome API调用次数
    - **错误处理**：统一的错误处理机制，提供详细错误信息
    - **React Hook模式**：现代化的状态管理，支持加载状态和错误状态
    - **数据验证**：严格的数据格式验证，确保数据一致性
    - **批量操作**：支持批量添加/删除书签，提高操作效率
    - **搜索和排序**：内置搜索和排序功能，提升用户体验
    - **备份恢复**：完整的数据备份和恢复机制
    - **API管理**：Unsplash API限制监控和管理
  
- [ ] 子功能 1.3：配置路由与页面结构
  - 设置newtab页面路由
  - 设置popup页面路由
  - 配置基础布局组件

## 功能模块 2：核心书签系统（优先级：高）
- [ ] 子功能 2.1：书签数据管理
  - 实现BookmarkManager React组件
  - 实现书签CRUD操作（增删改查）
  - 实现书签渲染网格组件
  
- [ ] 子功能 2.2：书签弹窗系统
  - 实现添加/编辑书签Modal组件
  - 实现图标选择器（官方、文字、上传三种类型）
  - 实现颜色选择器组件
  
- [ ] 子功能 2.3：内外网双模式支持
  - 实现网络模式切换组件
  - 实现根据模式显示对应URL的逻辑
  - 实现模式切换时的书签更新

## 功能模块 3：分类管理系统（优先级：高）
- [ ] 子功能 3.1：分类基础功能
  - 实现分类选择器组件
  - 实现分类创建/编辑Modal
  - 实现分类图标与颜色自定义
  
- [ ] 子功能 3.2：分类与书签关联
  - 实现书签按分类过滤显示
  - 实现分类切换动画效果
  - 实现书签与分类的关联管理

## 功能模块 4：背景图片系统（优先级：中）
- [ ] 子功能 4.1：背景图片基础功能
  - 实现背景图片显示组件
  - 实现刷新背景按钮
  - 迁移本地默认背景图片
  
- [ ] 子功能 4.2：Unsplash API集成
  - 实现Unsplash API调用
  - 实现图片缓存系统
  - 实现API限额监控与回退机制
  
- [ ] 子功能 4.3：背景图片归属信息
  - 实现图片信息展示组件
  - 实现归属信息的获取与显示

## 功能模块 5：搜索与导航（优先级：中）
- [ ] 子功能 5.1：搜索功能
  - 实现搜索输入框组件
  - 实现Google搜索表单提交
  - 实现搜索框样式与交互
  
- [ ] 子功能 5.2：时钟组件
  - 实现数字时钟显示
  - 实现时间格式化
  - 实现时钟更新逻辑

## 功能模块 6：WebDAV同步系统（优先级：中）
- [ ] 子功能 6.1：WebDAV配置
  - 实现WebDAV配置Modal
  - 实现连接测试功能
  - 实现配置信息的存储与加载
  
- [ ] 子功能 6.2：同步功能
  - 实现数据上传/下载逻辑
  - 实现自动同步机制
  - 实现同步状态显示
  
- [ ] 子功能 6.3：冲突处理
  - 实现数据冲突检测
  - 实现冲突解决界面
  - 实现备份与恢复功能

## 功能模块 7：弹出窗口(Popup)（优先级：中）
- [ ] 子功能 7.1：快速添加书签
  - 实现Popup页面布局
  - 实现当前页面信息自动填充
  - 实现快速添加表单提交
  
- [ ] 子功能 7.2：Popup界面优化
  - 实现适合扩展窗口的样式
  - 实现表单验证与错误提示
  - 实现分类选择集成

## 功能模块 8：高级功能与优化（优先级：低）
- [ ] 子功能 8.1：性能优化
  - 实现毛玻璃效果切换
  - 实现性能检测与自适应
  - 实现操作锁定机制
  
- [ ] 子功能 8.2：用户体验优化
  - 实现分类切换动画
  - 实现加载状态指示
  - 实现错误处理与用户反馈
  
- [ ] 子功能 8.3：右键菜单与快捷操作
  - 实现右键菜单拦截
  - 实现书签快捷编辑/删除
  - 实现键盘快捷键支持

## 功能模块 9：后台脚本与内容脚本（优先级：低）
- [ ] 子功能 9.1：后台服务worker
  - 迁移background.js功能
  - 实现书签刷新消息处理
  - 实现扩展生命周期管理
  
- [ ] 子功能 9.2：内容脚本
  - 迁移content-script.js功能
  - 实现页面信息提取
  - 实现与background的通信

## 功能模块 10：最终整合与测试（优先级：低）
- [ ] 子功能 10.1：功能整合测试
  - 测试所有功能模块集成
  - 修复功能间的兼容性问题
  - 优化整体性能表现
  
- [ ] 子功能 10.2：打包与部署
  - 配置生产环境构建
  - 生成Chrome插件包
  - 验证插件安装与运行

---

## 工作说明
1. 每次只实现一个子功能，完成后等待验证
2. 优先完成高优先级功能模块
3. 每个子功能完成后会标记完成状态并记录实现详情
4. 严格按照React + Shadcn/UI技术栈要求实现
